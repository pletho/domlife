export class GnuAdminAdapter{constructor({base='/adm',token=null}={}){this.base=base;this.token=token}async _req(url,body,{timeout=10000}={}){const c=new AbortController();const t=setTimeout(()=>c.abort('timeout'),timeout);const res=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...(this.token?{'X-CSRF-Token':this.token}:{})},body:JSON.stringify(body||{}),signal:c.signal}).catch(e=>{clearTimeout(t);throw e});clearTimeout(t);if(!res.ok)throw new Error('HTTP '+res.status);return res.json().catch(()=>({}))}create(p,b,o){return this._req(`${this.base}/domlife.ajax.php?action=create`,b,o)}read(p,b,o){return this._req(`${this.base}/domlife.ajax.php?action=read`,b,o)}update(p,b,o){return this._req(`${this.base}/domlife.ajax.php?action=update`,b,o)}delete(p,b,o){return this._req(`${this.base}/domlife.ajax.php?action=delete`,b,o)}query(p,b,o){return this._req(`${this.base}/domlife.ajax.php?action=query`,b,o)}}